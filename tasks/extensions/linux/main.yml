# NOTE: To find extension ID, install the ext, enable developer mode,
#       and then go to chrome://extensions.
# Also see https://www.chromium.org/administrators/policy-list-3#ExtensionInstallForcelist

- name: "Initialize local policy-setting-var to assemble extension IDs"
  ansible.builtin.set_fact:
    extension_ids: []

- name: "Install https-everywhere extension via policy: {{ install_https_everywhere_ext }}"
  ansible.builtin.set_fact:
    extension_ids: "{{ extension_ids + [ ext_id ] }}"
  vars:
    ext_id: ' "gcbommkclmclpchllfjekcdonpmejbdp"'
  when: install_https_everywhere_ext

- name: "Install ublock-origin extension via policy: {{ install_ublock_origin_ext }}"
  ansible.builtin.set_fact:
    extension_ids: "{{ extension_ids + [ ext_id ] }}"
  vars:
    ext_id: ' "cjpalhdlnbpafiamejdnhcphjbkeiagm"'
  when: install_ublock_origin_ext

- name: "Install vimium extension via policy: {{ install_vimium_ext }}"
  ansible.builtin.set_fact:
    extension_ids: "{{ extension_ids + [ ext_id ] }}"
  vars:
    ext_id: ' "dbepggeogbaibhgnhhndojpepiihcmeb"'
  when: install_vimium_ext

- name: "Add vimium config file, at '{{ vimium_config_file_path }}'"
  ansible.builtin.template:
    dest: "{{ vimium_config_file_path }}"
    src: 'vimium_config.j2'
    owner: 'root'
    group: 'root'
    mode: '644'
    force: yes
  become: true
  become_user: root

- name: "Add policy setting used to install extensions via extension IDs"
  ansible.builtin.include_tasks: func/edit_array_policy.yml
  vars:
    policy_name: "ExtensionInstallForcelist"
    array_element_list: "{{ extension_ids }}"
    locked: true
    last_entry: true

